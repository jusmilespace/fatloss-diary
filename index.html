<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ju Smile æ¸›è„‚æ—¥èªŒ</title>
  <meta name="theme-color" content="#97d0ba">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="icon" href="icon-192.png" sizes="192x192">
  <link rel="stylesheet" href="styles.css">
  <style>
    /* è£œä¸€äº›å°æ¨£å¼ï¼ˆå…¶é¤˜ç”¨ä½ çš„ styles.cssï¼‰ */
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .card{background:#fff;border:1px solid var(--border,#e9ecef);border-radius:14px;padding:16px;margin:14px 0}
    .row3,.row4{display:grid;gap:12px}
    .row3{grid-template-columns:1fr 1fr 1fr}
    .row4{grid-template-columns:1fr 1fr 1fr 1fr}
    label{display:block;margin:2px 0 6px;font-weight:600;color:#334}
    input,select,button{width:100%;padding:10px;border:1px solid #dfe3e6;border-radius:10px;background:#fff}
    button{cursor:pointer}
    .muted{color:#666;font-size:12px}
    .table{width:100%;border-collapse:collapse}
    .table th,.table td{padding:8px;border-bottom:1px solid #eef2f4;text-align:left}
    .progress{height:28px;background:#eef6f3;border-radius:12px;overflow:hidden}
    .bar{height:100%;background:var(--mint,#97d0ba);color:#fff;display:flex;align-items:center;justify-content:center}
    .typeahead{position:relative}
    .typeahead-panel{position:absolute;inset:auto 0 0 0;transform:translateY(100%);background:#fff;border:1px solid #e7ecef;border-radius:10px;box-shadow:0 6px 16px rgba(0,0,0,.06);max-height:240px;overflow:auto;z-index:30}
    .typeahead-item{display:flex;justify-content:space-between;gap:8px;padding:8px 10px;cursor:pointer}
    .typeahead-item.active,.typeahead-item:hover{background:#f3faf7}
    .typeahead-mark{background:#fffdc7}
    .tag{font-size:12px;color:#0d4a3c;opacity:.7}
    dialog.card { border:0; border-radius:14px; padding:18px 20px; }
    dialog::backdrop { background: rgba(0,0,0,.25); }
    .btn-primary{background:#97d0ba;color:#fff;border:1px solid rgba(0,0,0,.05)}
    .btn-danger{background:#fdeaea;color:#a33a3a;border:1px solid #f4cfcf}
    .btn-ghost{background:#eef6f3;color:#0d4a3c;border:1px solid #cfe8df}
  </style>
</head>
<body>
<div class="wrap">

  <header class="card">
    <h1>Ju Smile æ¸›è„‚æ—¥èªŒ <small id="appVer" class="muted"></small></h1>
    <div class="row4">
      <div>
        <label>æ¯æ—¥ç†±é‡ç›®æ¨™</label>
        <input id="setCal" type="number" placeholder="ä¾‹ï¼š1300">
      </div>
      <div>
        <label>æ¯æ—¥è›‹ç™½è³ªç›®æ¨™ (g)</label>
        <input id="setProtein" type="number" placeholder="ä¾‹ï¼š160">
      </div>
      <div>
        <label>ç›®å‰é«”é‡ (kg)</label>
        <input id="setWeight" type="number" step="0.1" placeholder="ä¾‹ï¼š70">
      </div>
      <div>
        <label>&nbsp;</label>
        <button id="btnSaveTargets" class="btn-primary">å„²å­˜ç›®æ¨™/é«”é‡</button>
      </div>
    </div>
  </header>

  <section class="card">
    <h2>é£²é£Ÿç´€éŒ„ï¼ˆä¸‰ç¨®è¼¸å…¥ä»»é¸ï¼‰</h2>

    <!-- é¤åˆ¥ -->
    <div class="row3">
      <div>
        <label>é¤åˆ¥</label>
        <select id="foodMeal">
          <option>æ—©é¤</option>
          <option>åˆé¤</option>
          <option>æ™šé¤</option>
          <option>é»å¿ƒ</option>
          <option>å®µå¤œ</option>
        </select>
      </div>
      <div></div><div></div>
    </div>

    <!-- åç¨± / æ•¸é‡ / å–®ä½ -->
    <div class="row3">
      <div>
        <label>é£Ÿç‰©åç¨±ï¼ˆæ”¯æ´æœå°‹/åˆ¥åï¼‰</label>
        <div class="typeahead">
          <input id="foodName" class="typeahead-input" placeholder="æœå°‹ï¼šç™½é£¯ / é›è…¿ä¾¿ç•¶ / è±†æ¼¿â€¦">
          <div id="foodSuggest" class="typeahead-panel" hidden></div>
        </div>
        <small class="muted">è¼¸å…¥é—œéµå­—æœƒå‡ºç¾å»ºè­°ï¼›â†‘â†“ç§»å‹•ã€Enteré¸å–</small>
      </div>
      <div>
        <label>æ•¸é‡</label>
        <input id="foodQty" type="number" inputmode="decimal" step="0.1" value="1">
        <small class="muted">å¯ 0.5 / 1 / 2â€¦ï¼ˆå€ç‡ï¼‰</small>
      </div>
      <div>
        <label>å–®ä½</label>
        <select id="foodUnit">
          <option value="">é¸æ“‡å–®ä½</option>
          <option value="g">gï¼ˆå…¬å…‹ï¼‰</option>
          <option value="ml">mlï¼ˆæ¯«å‡ï¼‰</option>
          <option value="å€‹">å€‹</option>
          <option value="ç¢—">ç¢—</option>
          <option value="ç‰‡">ç‰‡</option>
          <option value="æ¹¯åŒ™">æ¹¯åŒ™</option>
          <option value="å¼µ">å¼µ</option>
          <option value="ç²’">ç²’</option>
          <option value="æ¯">æ¯</option>
        </select>
        <small id="unitHint" class="muted">è¼¸å…¥åç¨±æ™‚è‹¥åŒ¹é…è³‡æ–™åº«ï¼Œæœƒè‡ªå‹•å¸¶å‡ºå¯ç”¨å–®ä½ä¸¦æ›ç®—ä»½é‡</small>
      </div>
    </div>

    <!-- Type Ã— è¨ˆç®—ä»½é‡ -->
    <div class="row3">
      <div>
        <label>é¡åˆ¥ Type</label>
        <select id="foodType">
          <option value="">ï¼ˆå¯ä¸é¸ï¼‰</option>
          <option>å…¨ç©€é›œç³§é¡</option>
          <option>è±†é­šè›‹è‚‰é¡ï¼ˆä½è„‚ï¼‰</option>
          <option>è±†é­šè›‹è‚‰é¡ï¼ˆä¸­è„‚ï¼‰</option>
          <option>è±†é­šè›‹è‚‰é¡ï¼ˆé«˜è„‚ï¼‰</option>
          <option>ä¹³å“é¡ï¼ˆå…¨è„‚ï¼‰</option>
          <option>ä¹³å“é¡ï¼ˆä½è„‚ï¼‰</option>
          <option>ä¹³å“é¡ï¼ˆè„«è„‚ï¼‰</option>
          <option>è”¬èœé¡</option>
          <option>æ°´æœé¡</option>
          <option>æ²¹è„‚èˆ‡å …æœç¨®å­é¡</option>
          <option>ç”œé»é£²æ–™ï¼ˆç³–ï¼‰</option>
          <option>æ‰‹æ–é£²ï¼ˆå¥¶èŒ¶åŸºæº–ï¼‰</option>
          <option>æ··åˆæ–™ç†ï¼ˆä¾¿ç•¶å°æ ¼ï¼‰</option>
        </select>
      </div>
      <div>
        <label>è¨ˆç®—ä»½é‡</label>
        <input id="foodServings" type="number" step="0.1" placeholder="ä¾‹ï¼š1.5">
      </div>
      <div>
        <label>&nbsp;</label>
        <button id="btnAutoFill" class="btn-ghost" style="width:100%">è‡ªå‹•å¸¶å…¥</button>
      </div>
    </div>

    <!-- K / P C F -->
    <div class="row4">
      <div><label>kcal</label><input id="foodKcal" type="number"></div>
      <div><label>è›‹ç™½è³ª (g)</label><input id="foodProtein" type="number"></div>
      <div><label>ç¢³æ°´ (g)</label><input id="foodCarb" type="number"></div>
      <div><label>è„‚è‚ª (g)</label><input id="foodFat" type="number"></div>
    </div>

    <div class="row3" style="margin-top:10px">
      <button id="btnAddFood" class="btn-primary">åŠ å…¥ä»Šæ—¥ç´€éŒ„</button>
      <button id="btnClearFoods" class="btn-danger">æ¸…ç©ºä»Šå¤©é£²é£Ÿ</button>
      <div></div>
    </div>

    <table class="table" style="margin-top:10px">
      <thead>
        <tr>
          <th>é¤åˆ¥</th><th>åç¨±</th><th>æ•¸é‡</th><th>å–®ä½</th>
          <th>kcal</th><th>è›‹ç™½è³ª</th><th>ç¢³æ°´</th><th>è„‚è‚ª</th><th></th>
        </tr>
      </thead>
      <tbody id="foodTable"></tbody>
    </table>
  </section>

  <section class="card">
    <h2>é‹å‹•ç´€éŒ„</h2>
    <div class="row4">
      <div>
        <label>é‹å‹•åç¨±</label>
        <input id="exName" list="exList" placeholder="ä¾‹ï¼šå¿«èµ° / é‡è¨“ / æ¸¸æ³³â€¦">
        <datalist id="exList"></datalist>
      </div>
      <div>
        <label>METï¼ˆä»£è¬ç•¶é‡ï¼‰
          <span title="1 MET â‰ˆ éœåæ™‚æ¶ˆè€—ï¼›é‹å‹•ç†±é‡ â‰ˆ MET Ã— 3.5 Ã— é«”é‡(kg) Ã· 200 Ã— åˆ†é˜ã€‚è‹¥ä¸åœ¨æ¸…å–®ï¼Œè«‹è‡ªè¡Œè¼¸å…¥ METã€‚">â“˜</span>
        </label>
        <input id="exMET" type="number" step="0.1" placeholder="ä¾‹ï¼šå¿«èµ° 3.5ã€æ…¢è·‘ 7">
        <small class="muted">åç¨±ä¸åœ¨æ¸…å–®ä¹Ÿå¯ç›´æ¥è¼¸å…¥ MET å¾ŒåŠ å…¥ã€‚</small>
      </div>
      <div>
        <label>åˆ†é˜</label>
        <input id="exMins" type="number" value="30">
      </div>
      <div>
        <label>é«”é‡ (kg)</label>
        <input id="userWeight" type="number" step="0.1" placeholder="é è¨­ç”¨ä¸Šæ–¹é«”é‡">
      </div>
    </div>
    <div class="row3" style="margin-top:10px">
      <button id="btnAddEx" class="btn-primary">åŠ å…¥é‹å‹•</button>
      <button id="btnClearExToday" class="btn-danger">æ¸…ç©ºä»Šå¤©é‹å‹•</button>
      <div></div>
    </div>

    <table class="table" style="margin-top:10px">
      <thead><tr><th>åç¨±</th><th>MET</th><th>åˆ†é˜</th><th>kcal</th><th></th></tr></thead>
      <tbody id="exTable"></tbody>
    </table>
  </section>

  <section class="card">
    <h2>ä»Šæ—¥çµ±è¨ˆ</h2>
    <div class="row4">
      <div><label>æ”å…¥ kcal</label><div id="sumKcal">0</div></div>
      <div><label>é‹å‹•æ¶ˆè€— kcal</label><div id="exKcal">0</div></div>
      <div><label>æ·¨ç†±é‡ kcal</label><div id="netKcal">0</div></div>
      <div></div>
    </div>
    <div class="progress" style="margin-top:10px"><div class="bar" id="calBar" style="width:0%">0/0 kcal</div></div>
  </section>

  <section class="card">
    <h2>ğŸ§º å¸¸ç”¨é£Ÿç‰©çµ„åˆï¼ˆå¿«é€ŸåŠ å…¥ï¼‰</h2>
    <div class="row3">
      <div><label>åç¨±</label><input id="presetName" placeholder="ä¾‹ï¼šé›è…¿ä¾¿ç•¶"></div>
      <div><label>&nbsp;</label><button id="btnSavePreset" class="btn-primary">æŠŠã€Œä»Šå¤©çš„é£²é£Ÿæ˜ç´°ã€å­˜æˆçµ„åˆ</button></div>
      <div><label>&nbsp;</label><button id="btnClearPresets" class="btn-danger">æ¸…ç©ºå…¨éƒ¨çµ„åˆ</button></div>
    </div>
    <table class="table" style="margin-top:10px">
      <thead><tr><th>åç¨±</th><th>å“é …æ•¸</th><th></th></tr></thead>
      <tbody id="presetTable"></tbody>
    </table>
  </section>

  <!-- çµ„åˆç·¨è¼¯ dialog -->
  <dialog id="presetEditor" class="card" style="max-width:720px;width:90%">
    <h3 id="peTitle">ç·¨è¼¯çµ„åˆ</h3>
    <table class="table">
      <thead><tr><th>#</th><th>åç¨±</th><th>kcal</th><th>è›‹ç™½è³ª</th><th>ç¢³æ°´</th><th>è„‚è‚ª</th><th></th></tr></thead>
      <tbody id="peBody"></tbody>
    </table>
    <div class="row3">
      <button id="peClose" class="btn-ghost">é—œé–‰</button>
      <button id="peSave" class="btn-primary">å„²å­˜è®Šæ›´</button>
      <button id="peDelete" class="btn-danger">åˆªé™¤æ•´å€‹çµ„åˆ</button>
    </div>
  </dialog>

  <section class="card">
    <h2>è¨­å®šèˆ‡åŒæ­¥ï¼ˆå¯è²¼ CSV é€£çµï¼‰</h2>
    <div class="row3">
      <div>
        <label>é¡åˆ¥è¡¨ TYPE_TABLE CSV</label>
        <input id="typeCsvUrl" placeholder="https://.../TYPE_TABLE.csv">
        <button id="btnSyncTypeCsv" class="btn-ghost">åŒæ­¥ï¼ˆé¡åˆ¥è¡¨ï¼‰</button>
      </div>
      <div>
        <label>å–®ä½æ›ç®— UNIT_MAP CSV</label>
        <input id="unitCsvUrl" placeholder="https://.../UNIT_MAP.csv">
        <button id="btnSyncUnitCsv" class="btn-ghost">åŒæ­¥ï¼ˆå–®ä½æ›ç®—ï¼‰</button>
      </div>
      <div>
        <label>ç²¾æº–é£Ÿç‰© FOOD_DB CSV</label>
        <input id="foodCsvUrl" placeholder="https://.../FOOD_DB.csv">
        <button id="btnSyncFoodCsv" class="btn-ghost">åŒæ­¥ï¼ˆç²¾æº–ï¼‰</button>
      </div>
    </div>
  </section>

  <footer class="card">
    <small class="muted">Â© Ju Smile æ¸›è„‚æ—¥èªŒ</small>
  </footer>

</div>
<script src="app.js"></script>
</body>
</html>
